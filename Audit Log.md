1. ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Audit Log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π
‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏Ñ‡πà "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö" ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö "Activity Logs" (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°) ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö:

Centralized Log Table: ‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "Module/Menu" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏´‡∏ô (‡πÄ‡∏ä‡πà‡∏ô Head Count Planning, PE Bonus)

Action Types: ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥ ‡πÄ‡∏ä‡πà‡∏ô Create (‡∏™‡∏£‡πâ‡∏≤‡∏á), View (‡∏î‡∏π), Update (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç), Delete (‡∏•‡∏ö), Export (‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å)

Deep Link: ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Audit Log ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà "‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ" ‡πÉ‡∏ô Audit Log (5W1H)‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Audit Log ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö:‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢Who (‡πÉ‡∏Ñ‡∏£)User ID / Username / Role‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏≥ (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á IP Address ‡πÅ‡∏•‡∏∞ Device ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)When (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà)Timestamp‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)Where (‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô)Module / Menu / URL‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏´‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ API ‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏ôWhat (‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£)Action / Event‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ ‡πÄ‡∏ä‡πà‡∏ô "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÇ‡∏ö‡∏ô‡∏±‡∏™", "‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô"Result (‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå)Success / Fail‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ï‡∏¥‡∏î Error ‡∏≠‡∏∞‡πÑ‡∏£Details (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)Old Value vs New Value(‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å) ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£

3. ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö Audit Log (Best Practices)
‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Sensitive Data): ‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password), ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Log ‡∏ï‡∏£‡∏á‡πÜ

Data Retention: ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö Log ‡πÑ‡∏ß‡πâ‡∏ô‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà (‡πÄ‡∏ä‡πà‡∏ô 90 ‡∏ß‡∏±‡∏ô, 1 ‡∏õ‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ 5 ‡∏õ‡∏µ‡∏ï‡∏≤‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó) ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö

Read-Only: Audit Log ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢ User ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πâ‡πÅ‡∏ï‡πà Admin ‡∏Å‡πá‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏•‡∏ö‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ)

Performance: ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Log ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ä‡πâ‡∏≤‡∏•‡∏á ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö Background Task ‡∏´‡∏£‡∏∑‡∏≠ Asynchronous ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö BJC Budget Planning ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö (Traceability) ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏ú‡∏°‡∏Ç‡∏≠‡∏£‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á Database ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö

1. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á audit_logs
‡∏ú‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ü‡∏¥‡∏•‡∏î‡πå JSON ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏Å‡∏±‡∏ö ‡πÄ‡∏°‡∏ô‡∏π‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏°‡∏µ Field ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô)

Column Name	Data Type	Description
log_id	BigInt (PK)	‡πÑ‡∏≠‡∏î‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á Log (Auto Increment)
timestamp	DateTime	‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå (‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ UTC ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏∏ Timezone)
user_id	Varchar(50)	‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ Username ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
user_role	Varchar(50)	‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏±‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô Admin, Planner)
module_name	Varchar(100)	‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π (‡πÄ‡∏ä‡πà‡∏ô 'PE Bonus', 'Head Count Planning')
action	Varchar(20)	‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥: CREATE, UPDATE, DELETE, VIEW, EXPORT
target_id	Varchar(100)	PK ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏≥ (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏´‡∏£‡∏∑‡∏≠ ID ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)
old_value	JSON	‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON Object)
new_value	JSON	‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON Object)
ip_address	Varchar(45)	IP ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö IPv4/IPv6)
user_agent	Text	‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Browser ‡πÅ‡∏•‡∏∞ OS ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
status	Varchar(20)	‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: SUCCESS ‡∏´‡∏£‡∏∑‡∏≠ FAILED
remarks	Text	‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏´‡∏£‡∏∑‡∏≠ Error Message ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß

2. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Use Case)
‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç PE Bonus ‡∏Ç‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á:

module_name: PE Bonus (By Cost Center)

action: UPDATE

target_id: EMP001

old_value: {"bonus_rate": 1.5, "total_amount": 15000}

new_value: {"bonus_rate": 2.0, "total_amount": 20000}

3. ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û (Best Practices)
Indexing: ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á Log ‡∏à‡∏∞‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥ Index ‡πÉ‡∏ô Column ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡πÄ‡∏ä‡πà‡∏ô:

timestamp (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤)

user_id (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•)

module_name (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÄ‡∏°‡∏ô‡∏π)

Table Partitioning: ‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏≥ Partition ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏õ‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£ Query ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏õ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ö Performance ‡∏Ç‡∏≠‡∏á Database ‡∏´‡∏•‡∏±‡∏Å

JSON Search: ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏ä‡πà‡∏ô PostgreSQL, MySQL 8.0+, SQL Server 2016+) ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Query ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå JSON ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ "‡πÉ‡∏Ñ‡∏£‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤ Field ‡∏ô‡∏µ‡πâ‡∏ö‡πâ‡∏≤‡∏á"

Asynchronous Logging: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Log ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏°‡∏∏‡∏ô‡∏ä‡πâ‡∏≤ (Latency) ‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Log ‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡πà‡∏≤‡∏ô Queue ‡∏´‡∏£‡∏∑‡∏≠ Background Process ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÄ‡∏ã‡∏™‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà User ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

4. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á SQL Script (PostgreSQL/MySQL)

CREATE TABLE audit_logs (
    log_id SERIAL PRIMARY KEY,
    timestamp TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    user_id VARCHAR(50) NOT NULL,
    user_role VARCHAR(50),
    module_name VARCHAR(100) NOT NULL,
    action VARCHAR(20) NOT NULL,
    target_id VARCHAR(100),
    old_value JSONB, -- ‡∏´‡∏£‡∏∑‡∏≠ JSON
    new_value JSONB, -- ‡∏´‡∏£‡∏∑‡∏≠ JSON
    ip_address VARCHAR(45),
    user_agent TEXT,
    status VARCHAR(20) DEFAULT 'SUCCESS',
    remarks TEXT
);

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á Index ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
CREATE INDEX idx_audit_timestamp ON audit_logs(timestamp);
CREATE INDEX idx_audit_user ON audit_logs(user_id);
CREATE INDEX idx_audit_module ON audit_logs(module_name);

---

# üìã ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Audit Log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö BJC Budget Planning

## üîç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

### Log ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (3 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á)

| ‡∏ï‡∏≤‡∏£‡∏≤‡∏á | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|-------|--------|-------|-----------|
| `HRB_USER_LOGIN_LOG` | Login/Logout | ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö |
| `HRB_EMAIL_LOG` | Email Sending | ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• |
| `HRB_UPLOAD_LOG` | File Upload | ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå |

### Log ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà)

| ‡∏ï‡∏≤‡∏£‡∏≤‡∏á | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|-------|--------|---------|
| `HRB_ACTIVITY_LOG` | Activity Logs ‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π | CREATE, UPDATE, DELETE, VIEW, EXPORT, APPROVE, REJECT |

---

## üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π

### 1. Dashboard (Index.cshtml)

**Permission Required:** `PAGE_DASHBOARD`

| Action | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|--------|---------|-----------|
| VIEW | ‚ùì Optional | ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π Dashboard (Read-Only) |
| EXPORT | ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô KPI |

**APIs ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:**
- `GET /api/Summary/kpi-overview` - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• KPI

---

### 2. Head Count Planning (BudgetPlanning.cshtml + Budget.cshtml)

**Permission Required:** `PAGE_BUDGET`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | Old/New Value |
|--------|--------------|---------|---------------|
| VIEW | `GET /api/Budget/B0Budgets` | ‚ùì Optional | - |
| CREATE | `POST /api/Budget/...` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new_value: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| UPDATE | `PUT /api/Budget/...` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old_value + new_value |
| DELETE | `DELETE /api/Budget/...` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old_value: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏•‡∏ö |
| EXPORT | Excel Export | ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | filter parameters |

**Target ID:** `BudgetId` ‡∏´‡∏£‡∏∑‡∏≠ `CostCenterCode + BudgetYear`

---

### 3. PE Bonus (BudgetPEBonus.cshtml) - By Cost Center

**Permission Required:** `PAGE_PE`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|--------|--------------|---------|-----------|
| VIEW | `GET /api/Summary/...` | ‚ùì Optional | ‡∏´‡∏ô‡πâ‡∏≤ Report |
| EXPORT | Excel Export | ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | filter + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô rows |

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Report ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà Read-Only

---

### 4. PE Head Count (BudgetPEHeadCount.cshtml) - By Grouping

**Permission Required:** `PAGE_PE`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|--------|--------------|---------|-----------|
| VIEW | `GET /api/Summary/...` | ‚ùì Optional | ‡∏´‡∏ô‡πâ‡∏≤ Report |
| EXPORT | Excel Export | ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | filter + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô rows |

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Report ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà Read-Only

---

### 5. PE Management (BudgetPEManagement.cshtml) ‚≠ê **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å**

**Permission Required:** `PAGE_PE`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | Old/New Value |
|--------|--------------|---------|---------------|
| VIEW | `GET /api/PEManagement/GetAll` | ‚ùì Optional | - |
| **MOVE_IN** | `POST /api/PEManagement/MoveIn` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {HC, BaseWage ‡∏Å‡πà‡∏≠‡∏ô}, new: {HC, BaseWage ‡∏´‡∏•‡∏±‡∏á} |
| **MOVE_OUT** | `POST /api/PEManagement/MoveOut` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {HC, BaseWage ‡∏Å‡πà‡∏≠‡∏ô}, new: {HC, BaseWage ‡∏´‡∏•‡∏±‡∏á} |
| **ADDITIONAL** | `POST /api/PEManagement/Additional` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°, ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•} |
| **CUT** | `POST /api/PEManagement/Cut` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î, ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•} |
| **APPROVE** | `POST /api/PEManagement/Movement/Approve/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {approvedBy, remark} |
| **REJECT** | `POST /api/PEManagement/Movement/Reject/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {rejectedBy, reason} |
| **UPDATE_B0** | `PUT /api/PEManagement/UpdateB0/{peId}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {B0_HC, B0_BaseWage}, new: {B0_HC, B0_BaseWage} |
| UPLOAD | `POST /api/PEManagement/UploadFile` | ‚úÖ ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß | HRB_UPLOAD_LOG |

**Target ID:** `MovementId`, `PeId`, ‡∏´‡∏£‡∏∑‡∏≠ `CostCenterCode`

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Log:**
```json
{
  "module_name": "PE Management",
  "action": "MOVE_IN",
  "target_id": "CC001-2026-01",
  "old_value": {"b1_hc": 10, "b1_base_wage": 500000},
  "new_value": {"b1_hc": 12, "b1_base_wage": 600000, "move_in_qty": 2, "move_in_amount": 100000}
}
```

---

### 6. Settings - User Management

**Permission Required:** `PAGE_USER_MANAGEMENT`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | Old/New Value |
|--------|--------------|---------|---------------|
| VIEW | `GET /api/User/GetAll` | ‚ùì Optional | - |
| **CREATE** | `POST /api/User/Create` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {EmpCode, Username, RoleIds, ...} |
| **UPDATE** | `PUT /api/User/Update/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old + new (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡πá‡∏ö Password) |
| **DELETE** | `DELETE /api/User/Delete/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {EmpCode, Username} |
| **ASSIGN_ROLES** | `POST /api/User/AssignRoles/{userId}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: [roleIds ‡∏Å‡πà‡∏≠‡∏ô], new: [roleIds ‡∏´‡∏•‡∏±‡∏á] |

**Target ID:** `UserId`

**‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:** ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡πá‡∏ö Password ‡πÉ‡∏ô Log

---

### 7. Settings - Role Management

**Permission Required:** `PAGE_ROLE_MANAGEMENT`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | Old/New Value |
|--------|--------------|---------|---------------|
| VIEW | `GET /api/Role/GetAll` | ‚ùì Optional | - |
| **CREATE** | `POST /api/Role/Create` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {RoleCode, RoleName, Permissions} |
| **UPDATE** | `PUT /api/Role/Update/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old + new |
| **DELETE** | `DELETE /api/Role/Delete/{id}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {RoleCode, RoleName} |
| **ASSIGN_PERMISSIONS** | `POST /api/Role/AssignPermissions/{roleId}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: [permIds ‡∏Å‡πà‡∏≠‡∏ô], new: [permIds ‡∏´‡∏•‡∏±‡∏á] |

**Target ID:** `RoleId`

---

### 8. Settings - Master Data (Manage.cshtml)

**Permission Required:** `PAGE_SETTINGS`

| Action | API/Endpoint | ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö | Old/New Value |
|--------|--------------|---------|---------------|
| VIEW | `GET /api/Settings/getdata/{modelName}` | ‚ùì Optional | - |
| **CREATE** | `POST /api/Settings/create/{modelName}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | new: {‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á} |
| **UPDATE** | `PUT /api/Settings/update/{modelName}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old + new |
| **DELETE** | `DELETE /api/Settings/delete/{modelName}` | ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö** | old: {‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏•‡∏ö} |

**Target ID:** Primary Key ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ Model

**Models ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:**
- Company, CostCenter, Division, Department, Section
- Position, JobBand, EmployeeStatus, BenefitType
- ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ï‡∏≤‡∏° SettingsService

---

## üèóÔ∏è Implementation Plan

### Phase 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Database Table (SQL Server)

```sql
-- =============================================
-- Table: HRB_ACTIVITY_LOG
-- Purpose: Centralized Activity Log for All Modules
-- =============================================
CREATE TABLE [dbo].[HRB_ACTIVITY_LOG] (
    [LogId]         BIGINT IDENTITY(1,1) NOT NULL,
    [Timestamp]     DATETIME2(7) NOT NULL DEFAULT SYSUTCDATETIME(),
    [UserId]        NVARCHAR(50) NOT NULL,          -- EmpCode
    [Username]      NVARCHAR(100) NULL,             -- Display Name
    [UserRole]      NVARCHAR(50) NULL,              -- Role ‡∏Ç‡∏ì‡∏∞‡∏ó‡∏≥
    [ModuleName]    NVARCHAR(100) NOT NULL,         -- 'PE Management', 'User Management'
    [Action]        NVARCHAR(30) NOT NULL,          -- CREATE, UPDATE, DELETE, APPROVE, REJECT, EXPORT
    [TargetId]      NVARCHAR(100) NULL,             -- PK ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    [TargetType]    NVARCHAR(50) NULL,              -- Entity Type: 'Movement', 'User', 'Role'
    [OldValue]      NVARCHAR(MAX) NULL,             -- JSON
    [NewValue]      NVARCHAR(MAX) NULL,             -- JSON
    [IpAddress]     NVARCHAR(45) NULL,              -- IPv4/IPv6
    [UserAgent]     NVARCHAR(500) NULL,             -- Browser/OS
    [RequestUrl]    NVARCHAR(500) NULL,             -- API URL ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å
    [Status]        NVARCHAR(20) NOT NULL DEFAULT 'SUCCESS',  -- SUCCESS, FAILED
    [ErrorMessage]  NVARCHAR(MAX) NULL,             -- Error details if failed
    [DurationMs]    INT NULL,                       -- Execution time in milliseconds
    
    CONSTRAINT [PK_HRB_ACTIVITY_LOG] PRIMARY KEY CLUSTERED ([LogId] ASC)
);

-- =============================================
-- Indexes for Performance
-- =============================================
CREATE NONCLUSTERED INDEX [IX_ActivityLog_Timestamp] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([Timestamp] DESC);

CREATE NONCLUSTERED INDEX [IX_ActivityLog_UserId] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([UserId]);

CREATE NONCLUSTERED INDEX [IX_ActivityLog_ModuleName] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([ModuleName]);

CREATE NONCLUSTERED INDEX [IX_ActivityLog_Action] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([Action]);

CREATE NONCLUSTERED INDEX [IX_ActivityLog_TargetId] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([TargetId]);

-- Composite Index for common queries
CREATE NONCLUSTERED INDEX [IX_ActivityLog_Module_Timestamp] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([ModuleName], [Timestamp] DESC);

CREATE NONCLUSTERED INDEX [IX_ActivityLog_User_Timestamp] 
    ON [dbo].[HRB_ACTIVITY_LOG] ([UserId], [Timestamp] DESC);
```

### Phase 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Model & Service ‚úÖ **‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (6 ‡∏°.‡∏Ñ. 2569)**

**Files ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà:**
1. ‚úÖ `Models/Log/HRB_ACTIVITY_LOG.cs` - Entity Model
2. ‚úÖ `DTOs/AuditLog/AuditLogDto.cs` - ‡πÄ‡∏û‡∏¥‡πà‡∏° ActivityLogDto, CreateActivityLogRequest, ActivityLogQueryRequest
3. ‚úÖ `DTOs/AuditLog/AuditLogDto.cs` - ‡πÄ‡∏û‡∏¥‡πà‡∏° ActivityModules, ActivityActions constants

**Files ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‚úÖ `Models/HRBudgetDbContext.cs` - ‡πÄ‡∏û‡∏¥‡πà‡∏° DbSet<HRB_ACTIVITY_LOG>
2. ‚úÖ `Services/IAuditLogService.cs` - ‡πÄ‡∏û‡∏¥‡πà‡∏° Interface methods
3. ‚úÖ `Services/AuditLogService.cs` - Implement Activity Log methods

**Features ‡∏ó‡∏µ‡πà Implement:**
- `GetActivityLogsAsync()` - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Activity Logs ‡∏û‡∏£‡πâ‡∏≠‡∏° Filter
- `LogActivityAsync()` - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Activity Log
- `LogAsync()` - Helper method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ
- `GetDistinctModulesAsync()` - ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Module ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Dropdown
- `GetDistinctActionsAsync()` - ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Action ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Dropdown
- Sensitive Data Masking (Password, IDCard, etc.)
- Auto-capture: IP Address, User Agent, Request URL

### Phase 3: ‡πÄ‡∏û‡∏¥‡πà‡∏° Logging ‡πÉ‡∏ô Controllers

| Controller | Priority | Actions ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° Log |
|------------|----------|-------------------------|
| `PEManagementController` | üî¥ HIGH | MoveIn, MoveOut, Additional, Cut, Approve, Reject, UpdateB0 |
| `UserController` | üî¥ HIGH | Create, Update, Delete, AssignRoles |
| `RoleController` | üî¥ HIGH | Create, Update, Delete, AssignPermissions |
| `SettingsController` | üü° MEDIUM | Create, Update, Delete (‡∏ó‡∏∏‡∏Å Master Data) |
| `BudgetController` | üü° MEDIUM | Create, Update, Delete |

### Phase 4: ‡∏™‡∏£‡πâ‡∏≤‡∏á UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π Activity Log

**Option A:** ‡πÄ‡∏û‡∏¥‡πà‡∏° Tab ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô AuditLogs.cshtml
- Tab 1: Login Logs ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß
- Tab 2: Email Logs ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß  
- Tab 3: Upload Logs ‚úÖ ‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß
- Tab 4: **Activity Logs** üÜï ‡πÉ‡∏´‡∏°‡πà

**Option B:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å
- `/Settings/ActivityLogs`

---

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á (Best Practices)

### 1. ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
```csharp
// ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥
new_value: {"password": "12345", "idCard": "1234567890123"}

// ‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥
new_value: {"password": "***MASKED***", "idCard": "1-xxxx-xxxxx-xx-x"}
```

### 2. Async Logging (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πâ‡∏≤)
```csharp
// Fire and forget - ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
_ = _activityLogService.LogAsync(logRequest);

// ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Background Service / Queue
```

### 3. Data Retention Policy
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏Å‡πá‡∏ö Log: 90 ‡∏ß‡∏±‡∏ô / 1 ‡∏õ‡∏µ / 5 ‡∏õ‡∏µ
- ‡∏™‡∏£‡πâ‡∏≤‡∏á Job ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Archive ‡∏´‡∏£‡∏∑‡∏≠ Delete Log ‡πÄ‡∏Å‡πà‡∏≤

### 4. Read-Only Protection
- ‡πÑ‡∏°‡πà‡∏°‡∏µ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Update/Delete Log
- Database permission: SELECT only ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Application User

---

## üìå ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Priority)

| ‡∏•‡∏≥‡∏î‡∏±‡∏ö | ‡πÄ‡∏°‡∏ô‡∏π | Priority | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• |
|-------|------|----------|--------|
| 1 | PE Management | üî¥ HIGH | ‡∏°‡∏µ Transaction ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Move In/Out, Approve/Reject) |
| 2 | User Management | üî¥ HIGH | ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Security - ‡πÉ‡∏Ñ‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö User |
| 3 | Role Management | üî¥ HIGH | ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Security - Permission Changes |
| 4 | Master Data Settings | üü° MEDIUM | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö |
| 5 | Budget/Head Count | üü° MEDIUM | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì |
| 6 | Dashboard/Reports | üü¢ LOW | Optional (‡πÄ‡∏õ‡πá‡∏ô Read-Only) |

---

## üìù Action Module Names (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Logging)

```csharp
public static class ActivityModules
{
    // Main Modules
    public const string Dashboard = "Dashboard";
    public const string HeadCountPlanning = "Head Count Planning";
    public const string PEBonus = "PE Bonus";
    public const string PEHeadCount = "PE Head Count";
    public const string PEManagement = "PE Management";
    
    // Settings Modules
    public const string UserManagement = "User Management";
    public const string RoleManagement = "Role Management";
    public const string MasterData = "Master Data";
    public const string AuditLogs = "Audit Logs";
}

public static class ActivityActions
{
    public const string View = "VIEW";
    public const string Create = "CREATE";
    public const string Update = "UPDATE";
    public const string Delete = "DELETE";
    public const string Export = "EXPORT";
    public const string Import = "IMPORT";
    public const string Approve = "APPROVE";
    public const string Reject = "REJECT";
    public const string MoveIn = "MOVE_IN";
    public const string MoveOut = "MOVE_OUT";
    public const string Additional = "ADDITIONAL";
    public const string Cut = "CUT";
    public const string AssignRole = "ASSIGN_ROLE";
    public const string AssignPermission = "ASSIGN_PERMISSION";
}
```

---

## üóìÔ∏è ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå: 6 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2569



